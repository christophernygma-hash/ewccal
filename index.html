<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EWC Bonus Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        html {
            overflow-y: auto;
            overflow-x: hidden;
            height: 100%;
        }
        
        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: linear-gradient(135deg, #1a0b2e 0%, #5b3a82 50%, #e31837 100%);
            background-attachment: fixed;
            min-height: 100vh;
            padding: 20px;
            padding-bottom: 100px;
            position: relative;
            overflow-x: hidden;
            overflow-y: auto;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(227, 24, 55, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(91, 58, 130, 0.15) 0%, transparent 50%);
            animation: pulse 8s ease-in-out infinite;
            pointer-events: none;
        }
        
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.8; } }
        @keyframes slideIn { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes shimmer { 0% { background-position: -1000px 0; } 100% { background-position: 1000px 0; } }
        @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }
        
        .calculator {
            max-width: 560px;
            margin: 0 auto;
            margin-bottom: 60px;
            animation: slideIn 0.6s ease-out;
            position: relative;
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1), 0 2px 8px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #e31837 0%, #c91530 100%);
            padding: 32px 28px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: -50%; left: -50%; width: 200%; height: 200%;
            background: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255, 255, 255, 0.03) 10px, rgba(255, 255, 255, 0.03) 20px);
            animation: shimmer 20s linear infinite;
        }
        
        .header-content {
            position: relative;
            z-index: 1;
        }
        
        .logo {
            font-size: 0.75rem;
            letter-spacing: 3px;
            text-transform: uppercase;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .header h1 {
            font-size: 1.75rem;
            font-weight: 800;
            color: white;
            margin-bottom: 8px;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        
        .header p {
            font-size: 0.95rem;
            color: rgba(255, 255, 255, 0.95);
            font-weight: 500;
        }
        
        .form-body { 
            padding: 32px 28px;
            padding-bottom: 60px;
        }
        
        .metric-card {
            background: linear-gradient(135deg, #fafafa 0%, #ffffff 100%);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(0, 0, 0, 0.06);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .metric-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 3px;
            background: linear-gradient(90deg, #5b3a82, #e31837);
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
        }
        
        .metric-card:hover::before { opacity: 1; }
        
        .metric-card.has-value {
            background: linear-gradient(135deg, #f8f9ff 0%, #ffffff 100%);
            border-color: rgba(91, 58, 130, 0.2);
        }
        
        .metric-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }
        
        .metric-label {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .metric-label label {
            font-weight: 700;
            color: #1a1a1a;
            font-size: 0.95rem;
        }
        
        .info-icon {
            width: 18px; height: 18px;
            border-radius: 50%;
            background: linear-gradient(135deg, #5b3a82, #7b5ba2);
            color: white;
            font-size: 0.7rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: help;
            position: relative;
            transition: all 0.2s;
        }
        
        .info-icon:hover {
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(91, 58, 130, 0.4);
        }
        
        .info-icon .tooltip {
            position: absolute;
            bottom: calc(100% + 10px);
            left: 50%;
            transform: translateX(-50%);
            background: #1a1a1a;
            color: white;
            padding: 10px 14px;
            border-radius: 8px;
            font-size: 0.75rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            z-index: 100;
        }
        
        .info-icon .tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: #1a1a1a;
        }
        
        .info-icon:hover .tooltip { opacity: 1; }
        
        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: all 0.3s;
        }
        
        .status-badge.target {
            background: linear-gradient(135deg, #f5f5f5, #e8e8e8);
            color: #666;
        }
        
        .status-badge.met {
            background: linear-gradient(135deg, #d4edda, #b8e6c0);
            color: #155724;
            box-shadow: 0 2px 8px rgba(21, 87, 36, 0.2);
        }
        
        .input-wrapper {
            position: relative;
            margin-bottom: 12px;
        }
        
        .input-wrapper input {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e8e8e8;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            color: #1a1a1a;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: white;
        }
        
        .input-wrapper input:focus {
            outline: none;
            border-color: #5b3a82;
            box-shadow: 0 0 0 4px rgba(91, 58, 130, 0.1);
            transform: translateY(-1px);
        }
        
        .input-wrapper input::placeholder { color: #bbb; font-weight: 500; }
        
        .progress-container {
            position: relative;
            height: 10px;
            background: #f0f0f0;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 8px;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #5b3a82 0%, #7b5ba2 50%, #9b7bc2 100%);
            background-size: 200% 100%;
            border-radius: 10px;
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            animation: shimmer 3s linear infinite;
        }
        
        .progress-bar.target-met {
            background: linear-gradient(90deg, #28a745 0%, #34ce57 50%, #40e767 100%);
            background-size: 200% 100%;
        }
        
        .progress-stats {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            color: #666;
            font-weight: 600;
        }
        
        .progress-percent { color: #5b3a82; }
        
        .hours-check {
            background: linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%);
            border-radius: 16px;
            padding: 18px 20px;
            margin-bottom: 24px;
            border: 2px solid #e8e8e8;
            transition: all 0.3s;
        }
        
        .hours-check:has(input:checked) {
            background: linear-gradient(135deg, #f0f8ff 0%, #e6f2ff 100%);
            border-color: #5b3a82;
        }
        
        .hours-check label {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            font-weight: 600;
            color: #333;
            font-size: 0.9rem;
        }
        
        .hours-check input[type="checkbox"] {
            width: 24px;
            height: 24px;
            accent-color: #5b3a82;
            cursor: pointer;
        }
        
        /* Analytics Section */
        .analytics-section {
            background: linear-gradient(135deg, #f0f8ff 0%, #e6f2ff 100%);
            border-radius: 16px;
            margin-bottom: 24px;
            border: 2px solid #5b3a82;
            overflow: visible;
        }
        
        .analytics-header {
            padding: 18px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .analytics-header:hover {
            background: rgba(91, 58, 130, 0.05);
        }
        
        .analytics-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
            color: #5b3a82;
            font-size: 0.95rem;
        }
        
        .analytics-title .full-text {
            display: inline;
        }
        
        .analytics-title .short-text {
            display: none;
        }
        
        @media (max-width: 600px) {
            .analytics-title .full-text {
                display: none;
            }
            
            .analytics-title .short-text {
                display: inline;
            }
        }
        
        .analytics-icon {
            font-size: 1.2rem;
        }
        
        .analytics-toggle {
            font-size: 0.8rem;
            color: #5b3a82;
            transition: transform 0.3s;
        }
        
        .analytics-toggle.open {
            transform: rotate(180deg);
        }
        
        .analytics-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease-out, padding 0.4s ease-out;
            padding: 0 20px;
        }
        
        .analytics-content.open {
            max-height: 5000px;
            padding: 0 20px 20px 20px;
            overflow: visible;
        }
        
        .analytics-description {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 16px;
            line-height: 1.5;
        }
        
        .analytics-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 16px;
        }
        
        .analytics-input-group label {
            display: block;
            font-size: 0.8rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 6px;
        }
        
        .analytics-input-group input {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e8e8e8;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .analytics-input-group input:focus {
            outline: none;
            border-color: #5b3a82;
            box-shadow: 0 0 0 3px rgba(91, 58, 130, 0.1);
        }
        
        .btn-analytics {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #5b3a82 0%, #432e5f 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 0.85rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .btn-analytics:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(91, 58, 130, 0.3);
        }
        
        .insights-display {
            margin-top: 16px;
            display: none;
            overflow: visible;
        }
        
        .insights-display.show {
            display: block;
            animation: slideIn 0.4s ease-out;
        }
        
        .insight-card {
            background: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            border-left: 4px solid #5b3a82;
        }
        
        .insight-card.highlight {
            background: linear-gradient(135deg, #fff9e6 0%, #fffbf0 100%);
            border-left-color: #ffd700;
        }
        
        .insight-header {
            font-weight: 700;
            color: #5b3a82;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }
        
        .insight-stat {
            font-size: 0.85rem;
            color: #333;
            line-height: 1.6;
            margin-bottom: 4px;
        }
        
        .insight-stat strong {
            color: #e31837;
            font-weight: 700;
        }
        
        .insight-opportunity {
            background: linear-gradient(135deg, #d4edda 0%, #c8e6d0 100%);
            border-radius: 8px;
            padding: 12px;
            margin-top: 8px;
            border: 1px solid #28a745;
        }
        
        .insight-opportunity .title {
            font-weight: 700;
            color: #155724;
            margin-bottom: 6px;
            font-size: 0.85rem;
        }
        
        .insight-opportunity .detail {
            font-size: 0.8rem;
            color: #155724;
            line-height: 1.5;
        }
        
        .earnings-potential {
            background: linear-gradient(135deg, #e31837 0%, #c91530 100%);
            color: white;
            border-radius: 10px;
            padding: 14px;
            text-align: center;
            margin-top: 12px;
            font-weight: 700;
        }
        
        .earnings-potential .label {
            font-size: 0.75rem;
            opacity: 0.9;
            margin-bottom: 4px;
        }
        
        .earnings-potential .amount {
            font-size: 1.4rem;
            font-weight: 800;
        }
        
        .earnings-explainer {
            background: white;
            border-radius: 10px;
            padding: 14px;
            margin-bottom: 12px;
            border: 1px solid #e8e8e8;
        }
        
        .earnings-title {
            font-weight: 700;
            color: #5b3a82;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }
        
        .earnings-detail {
            font-size: 0.8rem;
            line-height: 1.7;
            color: #333;
        }
        
        .insight-explanation {
            margin: 8px 0;
        }
        
        .action-buttons {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
        }
        
        .btn {
            flex: 1;
            padding: 16px 24px;
            border: none;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            letter-spacing: 0.3px;
            text-transform: uppercase;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #5b3a82 0%, #432e5f 100%);
            color: white;
            box-shadow: 0 4px 16px rgba(91, 58, 130, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 24px rgba(91, 58, 130, 0.4);
        }
        
        .btn-primary:active { transform: translateY(-1px); }
        
        .btn-secondary {
            background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%);
            color: #333;
        }
        
        .btn-secondary:hover {
            background: linear-gradient(135deg, #e8e8e8 0%, #d8d8d8 100%);
            transform: translateY(-2px);
        }
        
        .btn-accent {
            background: linear-gradient(135deg, #e31837 0%, #c91530 100%);
            color: white;
            box-shadow: 0 4px 16px rgba(227, 24, 55, 0.3);
            display: none;
        }
        
        .btn-accent:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 24px rgba(227, 24, 55, 0.4);
        }
        
        .btn-accent.show { display: block; }
        
        .results {
            display: none;
            animation: slideIn 0.6s ease-out;
        }
        
        .results.show { display: block; }
        
        .results-header {
            text-align: center;
            margin-bottom: 24px;
        }
        
        .results-header h2 {
            font-size: 1.3rem;
            font-weight: 800;
            color: #1a1a1a;
            margin-bottom: 8px;
        }
        
        .results-header p {
            color: #666;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .target-overview {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }
        
        .target-chip {
            background: white;
            border-radius: 12px;
            padding: 16px 12px;
            text-align: center;
            border: 2px solid #e8e8e8;
            transition: all 0.3s;
        }
        
        .target-chip.met {
            background: linear-gradient(135deg, #d4edda 0%, #c8e6d0 100%);
            border-color: #28a745;
        }
        
        .target-chip.missed {
            background: linear-gradient(135deg, #f8d7da 0%, #f0c8ce 100%);
            border-color: #e31837;
        }
        
        .target-chip .icon {
            font-size: 1.5rem;
            margin-bottom: 6px;
        }
        
        .target-chip .label {
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            color: #666;
        }
        
        .target-chip.met .label { color: #155724; }
        .target-chip.missed .label { color: #721c24; }
        
        .bonus-item {
            background: white;
            border-radius: 12px;
            padding: 18px 20px;
            margin-bottom: 12px;
            border: 1px solid #e8e8e8;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }
        
        .bonus-item:hover {
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .bonus-item .label {
            font-weight: 600;
            color: #333;
            font-size: 0.95rem;
        }
        
        .bonus-item .tier {
            font-size: 0.7rem;
            color: #999;
            font-weight: 600;
            margin-left: 6px;
            text-transform: uppercase;
        }
        
        .bonus-item .amount {
            font-size: 1.3rem;
            font-weight: 800;
            color: #1a1a1a;
        }
        
        .extra-bonus-card {
            background: linear-gradient(135deg, #ffd700 0%, #ffb300 100%);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 8px 24px rgba(255, 215, 0, 0.4);
            animation: float 3s ease-in-out infinite;
        }
        
        .extra-bonus-card .icon {
            font-size: 2rem;
            margin-bottom: 8px;
        }
        
        .extra-bonus-card .text {
            font-weight: 800;
            color: #1a1a1a;
            font-size: 1rem;
        }
        
        .total-banner {
            background: linear-gradient(135deg, #e31837 0%, #c91530 100%);
            border-radius: 16px;
            padding: 24px;
            margin-top: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 8px 24px rgba(227, 24, 55, 0.4);
            position: relative;
            overflow: hidden;
        }
        
        .total-banner::before {
            content: '';
            position: absolute;
            top: -50%; left: -50%; width: 200%; height: 200%;
            background: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255, 255, 255, 0.05) 10px, rgba(255, 255, 255, 0.05) 20px);
        }
        
        .total-banner .content {
            position: relative;
            z-index: 1;
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }
        
        .total-banner .label {
            font-weight: 700;
            color: white;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .total-banner .amount {
            font-size: 2.2rem;
            font-weight: 900;
            color: white;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        
        .disclaimer {
            background: rgba(255, 255, 255, 0.9);
            border-left: 4px solid #e31837;
            border-radius: 8px;
            padding: 16px 18px;
            margin-top: 16px;
            font-size: 0.8rem;
            line-height: 1.6;
            color: #555;
        }
        
        .disclaimer strong {
            color: #e31837;
            font-weight: 700;
        }
        
        .info-guide {
            margin-top: 32px;
            padding: 20px;
            background: linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%);
            border-radius: 16px;
            border: 1px solid #e8e8e8;
        }
        
        .info-guide h3 {
            font-size: 0.85rem;
            font-weight: 800;
            color: #5b3a82;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .credit-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 10px;
        }
        
        .credit-item {
            background: white;
            padding: 10px 14px;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: 600;
            color: #333;
            border: 1px solid #e8e8e8;
        }
        
        .tier-section {
            margin-top: 20px;
            padding: 16px;
            background: white;
            border-radius: 12px;
            border: 1px solid #e8e8e8;
        }
        
        .tier-section:first-of-type {
            margin-top: 0;
        }
        
        .tier-section h4 {
            font-size: 0.9rem;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .tier-note {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            color: #856404;
            margin-bottom: 12px;
            border: 1px solid #ffeaa7;
        }
        
        .tier-table {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        
        .tier-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 12px;
            background: #fafafa;
            border-radius: 6px;
            font-size: 0.85rem;
            transition: all 0.2s;
        }
        
        .tier-row:hover {
            background: #f0f0f0;
            transform: translateX(4px);
        }
        
        .tier-row.tier-target {
            background: linear-gradient(135deg, #e6f2ff 0%, #d1e7ff 100%);
            border: 2px solid #5b3a82;
            font-weight: 700;
        }
        
        .tier-row.tier-target:hover {
            background: linear-gradient(135deg, #d1e7ff 0%, #c0dcff 100%);
        }
        
        .tier-row.current {
            background: linear-gradient(135deg, #f0e6ff 0%, #e6d9ff 100%);
            border: 2px solid #5b3a82;
            font-weight: 700;
            position: relative;
        }
        
        .tier-row.current:hover {
            background: linear-gradient(135deg, #e6d9ff 0%, #dccfff 100%);
        }
        
        .tier-row.current::after {
            content: '(current)';
            font-size: 0.7rem;
            color: #5b3a82;
            font-weight: 700;
            margin-left: 6px;
        }
        
        .tier-range {
            font-weight: 600;
            color: #333;
        }
        
        .tier-value {
            font-weight: 700;
            color: #5b3a82;
            font-size: 0.9rem;
        }
        
        .bonus-note {
            margin-top: 16px;
            padding: 14px;
            background: linear-gradient(135deg, #fff9e6 0%, #ffe6b3 100%);
            border-radius: 8px;
            font-size: 0.8rem;
            color: #856404;
            line-height: 1.6;
            border: 1px solid #ffd700;
        }
        
        .bonus-note strong {
            color: #5b3a82;
        }
        
        @media (max-width: 600px) {
            html, body {
                overflow-y: auto !important;
                -webkit-overflow-scrolling: touch;
                height: auto !important;
                min-height: 100vh !important;
            }
            
            body { 
                padding: 10px;
                padding-bottom: 150px;
            }
            
            .calculator {
                min-height: auto;
                margin-bottom: 40px;
            }
            
            .glass-card {
                min-height: auto;
                overflow: visible !important;
            }
            
            .header { padding: 20px 16px; }
            .header h1 { font-size: 1.3rem; }
            
            .form-body { 
                padding: 20px 16px;
                padding-bottom: 60px;
                min-height: auto;
                overflow: visible !important;
            }
            
            .analytics-content.open {
                max-height: none !important;
                overflow: visible !important;
            }
            
            .insights-display {
                overflow: visible !important;
                max-height: none !important;
            }
            
            .action-buttons { flex-direction: column; }
            .btn-accent.show { display: block; width: 100%; }
            .target-overview { grid-template-columns: 1fr; }
            .total-banner .amount { font-size: 1.8rem; }
            .credit-grid { grid-template-columns: 1fr; }
            .analytics-inputs { grid-template-columns: 1fr; }
        }
        
        @media print {
            body { background: white; padding: 0; }
            body::before { display: none; }
            .glass-card { box-shadow: none; }
            .action-buttons, .info-guide, .analytics-section { display: none; }
            .results { display: block !important; }
        }
    </style>
</head>
<body>
    <div class="calculator">
        <div class="glass-card">
            <div class="header">
                <div class="header-content">
                    <div class="logo">European Wax Center</div>
                    <h1>Bonus Calculator</h1>
                    <p>Bi-Weekly Compensation Estimator</p>
                </div>
            </div>

            <div class="form-body">
                <div class="metric-card" id="serviceCard">
                    <div class="metric-header">
                        <div class="metric-label">
                            <label>Service Credits</label>
                            <div class="info-icon">
                                ?
                                <div class="tooltip">Brazilian/Bikini=2, Full Leg=2, Full Back=2, Full Arm=2, Full Face=4, Fast Facial=3, Others=1</div>
                            </div>
                        </div>
                        <span class="status-badge target" id="serviceBadge">Target: 195</span>
                    </div>
                    <div class="input-wrapper">
                        <input type="number" id="serviceCredits" placeholder="0" min="0">
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar" id="serviceProgress" style="width: 0%"></div>
                    </div>
                    <div class="progress-stats">
                        <span id="serviceStats">0 / 195 credits</span>
                        <span class="progress-percent" id="servicePercent">0%</span>
                    </div>
                </div>

                <div class="metric-card" id="retailCard">
                    <div class="metric-header">
                        <div class="metric-label">
                            <label>Retail Credits</label>
                            <div class="info-icon">
                                ?
                                <div class="tooltip">1 Credit = 1 Product Sold</div>
                            </div>
                        </div>
                        <span class="status-badge target" id="retailBadge">Target: 16</span>
                    </div>
                    <div class="input-wrapper">
                        <input type="number" id="retailCredits" placeholder="0" min="0">
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar" id="retailProgress" style="width: 0%"></div>
                    </div>
                    <div class="progress-stats">
                        <span id="retailStats">0 / 16 products</span>
                        <span class="progress-percent" id="retailPercent">0%</span>
                    </div>
                </div>

                <div class="metric-card" id="sptCard">
                    <div class="metric-header">
                        <div class="metric-label">
                            <label>Services Per Ticket</label>
                            <div class="info-icon">
                                ?
                                <div class="tooltip">Average services per guest visit</div>
                            </div>
                        </div>
                        <span class="status-badge target" id="sptBadge">Target: 1.70</span>
                    </div>
                    <div class="input-wrapper">
                        <input type="number" id="spt" placeholder="0.00" min="0" step="0.01">
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar" id="sptProgress" style="width: 0%"></div>
                    </div>
                    <div class="progress-stats">
                        <span id="sptStats">0.00 / 1.70 SPT</span>
                        <span class="progress-percent" id="sptPercent">0%</span>
                    </div>
                </div>

                <div class="hours-check">
                    <label>
                        <input type="checkbox" id="hoursWorked" checked>
                        <span>I worked 20+ hours this pay period (required for SPT bonus)</span>
                    </label>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="calculate()">‚ú® Calculate Bonus</button>
                    <button class="btn btn-secondary" onclick="reset()">Reset</button>
                </div>

                <div class="results" id="results">
                    <div class="results-header">
                        <h2>Your Bonus Breakdown</h2>
                        <p>Bi-weekly earnings based on performance</p>
                    </div>

                    <div class="target-overview" id="targetOverview"></div>
                    <div id="extraBonusContainer"></div>

                    <div class="bonus-item">
                        <div>
                            <span class="label">Service Bonus</span>
                            <span class="tier" id="serviceTier"></span>
                        </div>
                        <span class="amount" id="serviceAmount">$0</span>
                    </div>

                    <div class="bonus-item">
                        <div>
                            <span class="label">Retail Bonus</span>
                            <span class="tier" id="retailTier"></span>
                        </div>
                        <span class="amount" id="retailAmount">$0</span>
                    </div>

                    <div class="bonus-item">
                        <div>
                            <span class="label">SPT Bonus</span>
                            <span class="tier" id="sptTier"></span>
                        </div>
                        <span class="amount" id="sptAmount">$0</span>
                    </div>

                    <div class="total-banner">
                        <div class="content">
                            <span class="label">Total Bonus</span>
                            <span class="amount" id="totalAmount">$0</span>
                        </div>
                    </div>
                    
                    <div class="disclaimer">
                        <strong>‚ö†Ô∏è Important Notice:</strong> This calculator provides an estimate only and does not guarantee bonus eligibility or payout amount. For complete information regarding bonus structure and eligibility requirements, please contact your Center Manager or Josh.
                    </div>
                </div>

                <!-- Advanced Analytics Section - appears after results -->
                <div class="analytics-section" id="analyticsSection" style="display: none;">
                    <div class="analytics-header" onclick="toggleAnalytics()">
                        <div class="analytics-title">
                            <span class="analytics-icon">üí°</span>
                            <span class="full-text">Maximize Your Earnings (Past Period Analysis)</span>
                            <span class="short-text">Performance Analysis</span>
                        </div>
                        <span class="analytics-toggle" id="analyticsToggle">‚ñº</span>
                    </div>
                    
                    <div class="analytics-content" id="analyticsContent">
                        <p class="analytics-description">Enter your ticket and service data from this pay period to see what you could have earned differently.</p>
                        
                        <div class="analytics-inputs">
                            <div class="analytics-input-group">
                                <label>Total Tickets (Guests)</label>
                                <input type="number" id="totalTickets" placeholder="0" min="0">
                            </div>
                            
                            <div class="analytics-input-group">
                                <label>Total Services</label>
                                <input type="number" id="totalServices" placeholder="0" min="0">
                            </div>
                        </div>
                        
                        <button class="btn-analytics" onclick="calculateInsights()">üìä Show Insights</button>
                        
                        <div class="insights-display" id="insightsDisplay"></div>
                    </div>
                </div>

                <button class="btn btn-accent" id="printBtn" onclick="window.print()">üìÑ Print Results</button>

                <div class="info-guide">
                    <h3>üìã Service Credit Guide</h3>
                    <div class="credit-grid">
                        <div class="credit-item">Brazilian/Bikini = 2</div>
                        <div class="credit-item">Full Leg = 2</div>
                        <div class="credit-item">Full Back = 2</div>
                        <div class="credit-item">Full Arm = 2</div>
                        <div class="credit-item">Full Face PKG = 4</div>
                        <div class="credit-item">Fast Facial = 3</div>
                        <div class="credit-item">All Others = 1</div>
                    </div>
                </div>

                <div class="info-guide">
                    <h3>üí∞ Bonus Tier Structure</h3>
                    
                    <div class="tier-section">
                        <h4>Service Credit Tiers</h4>
                        <div class="tier-table" id="serviceTierTable">
                            <div class="tier-row" data-min="0" data-max="141">
                                <span class="tier-range">0 - 141</span>
                                <span class="tier-value">$0</span>
                            </div>
                            <div class="tier-row" data-min="142" data-max="194">
                                <span class="tier-range">142 - 194</span>
                                <span class="tier-value">$25</span>
                            </div>
                            <div class="tier-row tier-target" data-min="195" data-max="225">
                                <span class="tier-range">195 - 225 ‚≠ê Target</span>
                                <span class="tier-value">$80</span>
                            </div>
                            <div class="tier-row" data-min="226" data-max="280">
                                <span class="tier-range">226 - 280</span>
                                <span class="tier-value">$115</span>
                            </div>
                            <div class="tier-row" data-min="281" data-max="325">
                                <span class="tier-range">281 - 325</span>
                                <span class="tier-value">$275</span>
                            </div>
                            <div class="tier-row" data-min="326" data-max="365">
                                <span class="tier-range">326 - 365</span>
                                <span class="tier-value">$425</span>
                            </div>
                            <div class="tier-row" data-min="366" data-max="9999">
                                <span class="tier-range">366+</span>
                                <span class="tier-value">$425 + $1.50/credit</span>
                            </div>
                        </div>
                    </div>

                    <div class="tier-section">
                        <h4>Retail Credit Tiers</h4>
                        <div class="tier-table" id="retailTierTable">
                            <div class="tier-row" data-min="0" data-max="8">
                                <span class="tier-range">0 - 8</span>
                                <span class="tier-value">$0</span>
                            </div>
                            <div class="tier-row" data-min="9" data-max="12">
                                <span class="tier-range">9 - 12</span>
                                <span class="tier-value">$20</span>
                            </div>
                            <div class="tier-row" data-min="13" data-max="15">
                                <span class="tier-range">13 - 15</span>
                                <span class="tier-value">$30</span>
                            </div>
                            <div class="tier-row tier-target" data-min="16" data-max="18">
                                <span class="tier-range">16 - 18 ‚≠ê Target</span>
                                <span class="tier-value">$40</span>
                            </div>
                            <div class="tier-row" data-min="19" data-max="22">
                                <span class="tier-range">19 - 22</span>
                                <span class="tier-value">$55</span>
                            </div>
                            <div class="tier-row" data-min="23" data-max="27">
                                <span class="tier-range">23 - 27</span>
                                <span class="tier-value">$70</span>
                            </div>
                            <div class="tier-row" data-min="28" data-max="9999">
                                <span class="tier-range">28+</span>
                                <span class="tier-value">$80 + $2/unit</span>
                            </div>
                        </div>
                    </div>

                    <div class="tier-section">
                        <h4>Services Per Ticket (SPT) Tiers</h4>
                        <div class="tier-note">‚ö†Ô∏è Must work 20+ hours to earn SPT bonus</div>
                        <div class="tier-table" id="sptTierTable">
                            <div class="tier-row" data-min="0" data-max="1.49">
                                <span class="tier-range">< 1.50</span>
                                <span class="tier-value">$0</span>
                            </div>
                            <div class="tier-row" data-min="1.50" data-max="1.59">
                                <span class="tier-range">1.50 - 1.59</span>
                                <span class="tier-value">$125</span>
                            </div>
                            <div class="tier-row" data-min="1.60" data-max="1.69">
                                <span class="tier-range">1.60 - 1.69</span>
                                <span class="tier-value">$185</span>
                            </div>
                            <div class="tier-row tier-target" data-min="1.70" data-max="1.79">
                                <span class="tier-range">1.70 - 1.79 ‚≠ê Target</span>
                                <span class="tier-value">$250</span>
                            </div>
                            <div class="tier-row" data-min="1.80" data-max="1.89">
                                <span class="tier-range">1.80 - 1.89</span>
                                <span class="tier-value">$300</span>
                            </div>
                            <div class="tier-row" data-min="1.90" data-max="1.99">
                                <span class="tier-range">1.90 - 1.99</span>
                                <span class="tier-value">$350</span>
                            </div>
                            <div class="tier-row" data-min="2.00" data-max="9999">
                                <span class="tier-range">2.00+</span>
                                <span class="tier-value">$400</span>
                            </div>
                        </div>
                    </div>

                    <div class="bonus-note">
                        <strong>üéÅ Extra Bonus Opportunities:</strong><br>
                        Hit SPT target + 1 other target = <strong>+$100</strong><br>
                        Hit all 3 targets = <strong>+$200</strong>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('serviceCredits').addEventListener('input', updateServiceProgress);
        document.getElementById('retailCredits').addEventListener('input', updateRetailProgress);
        document.getElementById('spt').addEventListener('input', updateSPTProgress);
        document.getElementById('hoursWorked').addEventListener('change', updateSPTProgress);

        function toggleAnalytics() {
            const content = document.getElementById('analyticsContent');
            const toggle = document.getElementById('analyticsToggle');
            
            content.classList.toggle('open');
            toggle.classList.toggle('open');
        }

        function calculateInsights() {
            const tickets = parseFloat(document.getElementById('totalTickets').value) || 0;
            const services = parseFloat(document.getElementById('totalServices').value) || 0;
            const currentSC = parseFloat(document.getElementById('serviceCredits').value) || 0;
            const currentRC = parseFloat(document.getElementById('retailCredits').value) || 0;
            const hoursWorked = document.getElementById('hoursWorked').checked;
            
            if (tickets === 0 || services === 0) {
                alert('Please enter both tickets and services to see insights.');
                return;
            }
            
            const currentSPT = services / tickets;
            
            // Auto-fill SPT field if empty
            if (!document.getElementById('spt').value) {
                document.getElementById('spt').value = currentSPT.toFixed(2);
                updateSPTProgress();
            }
            
            // Determine next SPT tier
            let nextSPTTier = 0;
            let nextSPTBonus = 0;
            let currentSPTBonus = 0;
            
            if (currentSPT >= 2.00) {
                nextSPTTier = 2.00;
                nextSPTBonus = 400;
                currentSPTBonus = 400;
            } else if (currentSPT >= 1.90) {
                nextSPTTier = 2.00;
                nextSPTBonus = 400;
                currentSPTBonus = 350;
            } else if (currentSPT >= 1.80) {
                nextSPTTier = 1.90;
                nextSPTBonus = 350;
                currentSPTBonus = 300;
            } else if (currentSPT >= 1.70) {
                nextSPTTier = 1.80;
                nextSPTBonus = 300;
                currentSPTBonus = 250;
            } else if (currentSPT >= 1.60) {
                nextSPTTier = 1.70;
                nextSPTBonus = 250;
                currentSPTBonus = 185;
            } else if (currentSPT >= 1.50) {
                nextSPTTier = 1.60;
                nextSPTBonus = 185;
                currentSPTBonus = 125;
            } else {
                nextSPTTier = 1.50;
                nextSPTBonus = 125;
                currentSPTBonus = 0;
            }
            
            // Calculate services needed for next tier
            const servicesNeeded = Math.ceil(nextSPTTier * tickets);
            const servicesToAdd = Math.max(0, servicesNeeded - services);
            const newSPT = servicesNeeded / tickets;
            
            // Calculate bonus differential
            const sptBonusDiff = hoursWorked ? (nextSPTBonus - currentSPTBonus) : (nextSPTBonus - 0);
            
            // Calculate service credits - use MINIMUM 1 credit per service
            const minAdditionalSC = servicesToAdd * 1;
            const newSCMin = currentSC + minAdditionalSC;
            
            // Get current SC bonus
            function getSCBonus(credits) {
                if (credits >= 366) return 425 + (credits - 365) * 1.50;
                else if (credits >= 326) return 425;
                else if (credits >= 281) return 275;
                else if (credits >= 226) return 115;
                else if (credits >= 195) return 80;
                else if (credits >= 142) return 25;
                else return 0;
            }
            
            function getSCTier(credits) {
                if (credits >= 366) return '366+';
                else if (credits >= 326) return '326-365';
                else if (credits >= 281) return '281-325';
                else if (credits >= 226) return '226-280';
                else if (credits >= 195) return '195-225 (Target)';
                else if (credits >= 142) return '142-194';
                else return '0-141';
            }
            
            const currentSCBonus = getSCBonus(currentSC);
            const currentSCTier = getSCTier(currentSC);
            const newSCBonus = getSCBonus(newSCMin);
            const newSCTier = getSCTier(newSCMin);
            const scBonusDiff = newSCBonus - currentSCBonus;
            
            // Check current targets
            const currentServiceTarget = currentSC >= 195;
            const currentRetailTarget = currentRC >= 16;
            const currentSPTTarget = currentSPT >= 1.70 && hoursWorked;
            
            // Check new targets after adding services
            const newServiceTarget = newSCMin >= 195;
            const newRetailTarget = currentRC >= 16;
            const newSPTTarget = newSPT >= 1.70 && hoursWorked;
            
            // Calculate current extra bonus
            let currentExtraBonus = 0;
            if (currentServiceTarget && currentRetailTarget && currentSPTTarget) {
                currentExtraBonus = 200;
            } else if (currentSPTTarget && (currentServiceTarget || currentRetailTarget)) {
                currentExtraBonus = 100;
            }
            
            // Calculate new extra bonus
            let newExtraBonus = 0;
            if (newServiceTarget && newRetailTarget && newSPTTarget) {
                newExtraBonus = 200;
            } else if (newSPTTarget && (newServiceTarget || newRetailTarget)) {
                newExtraBonus = 100;
            }
            
            const extraBonusDiff = newExtraBonus - currentExtraBonus;
            const totalAdditionalEarnings = sptBonusDiff + scBonusDiff + extraBonusDiff;
            
            // Build insights HTML with PAST TENSE
            let insightsHTML = '';
            
            // Note about recalculation
            insightsHTML += `
                <div style="background: #fff3cd; padding: 12px; border-radius: 8px; margin-bottom: 16px; border: 1px solid #ffeaa7;">
                    <strong style="color: #856404;">üìä Analysis Based On:</strong>
                    <div style="color: #856404; font-size: 0.85rem; margin-top: 4px;">
                        ${tickets} guests you already saw with ${services} total services performed. If these numbers change, recalculate for updated insights.
                    </div>
                </div>
            `;
            
            // Current stats card
            insightsHTML += `
                <div class="insight-card">
                    <div class="insight-header">üìä Your Actual Performance</div>
                    <div class="insight-stat">You achieved: <strong>${currentSPT.toFixed(2)} SPT</strong></div>
                    <div class="insight-stat">${services} services performed for ${tickets} guests</div>
                    <div class="insight-stat">Service Credits earned: <strong>${currentSC}</strong> (Tier: ${currentSCTier})</div>
                    <div class="insight-stat">Retail Credits earned: <strong>${currentRC}</strong></div>
                    <div class="insight-stat" style="margin-top: 8px;">
                        Targets Hit: 
                        ${currentServiceTarget ? '<span style="color: #28a745;">‚úì Service</span>' : '<span style="color: #e31837;">‚úó Service</span>'}
                        ${currentRetailTarget ? '<span style="color: #28a745;">‚úì Retail</span>' : '<span style="color: #e31837;">‚úó Retail</span>'}
                        ${currentSPTTarget ? '<span style="color: #28a745;">‚úì SPT</span>' : '<span style="color: #e31837;">‚úó SPT</span>'}
                    </div>
                </div>
            `;
            
            // Opportunity card - PAST TENSE
            if (servicesToAdd > 0 && currentSPT < 2.00) {
                insightsHTML += `
                    <div class="insight-card highlight">
                        <div class="insight-header">üí° What You Could Have Earned</div>
                        
                        <div class="insight-explanation" style="background: #fff0f0; padding: 12px; border-radius: 8px; margin-bottom: 12px; border-left: 4px solid #e31837;">
                            <div style="font-size: 0.85rem; line-height: 1.6; color: #333;">
                                <strong>To have reached ${nextSPTTier.toFixed(2)} SPT:</strong><br>
                                You would have needed <strong>${servicesNeeded} total services</strong> with your ${tickets} guests.<br><br>
                                Since you performed ${services} services, you <strong>needed ${servicesToAdd} more</strong>.
                            </div>
                        </div>
                        
                        <div class="insight-opportunity">
                            <div class="title">üìù What This Means:</div>
                            <div class="detail">
                                You <strong>left ${servicesToAdd} service${servicesToAdd !== 1 ? 's' : ''}</strong> on the table with those ${tickets} guests
                            </div>
                            <div class="detail" style="margin-top: 8px;">
                                That's an average of <strong>${(servicesToAdd / tickets).toFixed(2)} missed services per guest</strong>
                            </div>
                        </div>
                        
                        <div class="insight-explanation" style="background: #e6f2ff; padding: 12px; border-radius: 8px; margin-top: 12px; border-left: 4px solid #5b3a82;">
                            <div style="font-size: 0.8rem; line-height: 1.6; color: #333;">
                                <strong>üí° In Simple Terms:</strong> ${(servicesToAdd / tickets).toFixed(2)} services per guest means about ${Math.ceil((servicesToAdd / tickets) * 10)} out of every 10 guests needed just one more service added (like adding underarm to a leg wax, or brow to a lip wax).
                            </div>
                        </div>
                        
                        <div style="margin-top: 20px; padding-top: 16px; border-top: 2px solid #e8e8e8;">
                            <div class="insight-header" style="margin-bottom: 12px;">üí∏ Money Left on the Table:</div>
                            
                            ${hoursWorked && sptBonusDiff > 0 ? `
                                <div class="earnings-explainer">
                                    <div class="earnings-title">‚ú® SPT Bonus You Missed: $${sptBonusDiff.toFixed(2)}</div>
                                    <div class="earnings-detail">
                                        <strong>Your SPT:</strong> ${currentSPT.toFixed(2)} = $${currentSPTBonus} bonus<br>
                                        <strong>If you hit ${nextSPTTier.toFixed(2)} SPT:</strong> Would have been $${nextSPTBonus} bonus<br>
                                        <strong>Missed earnings:</strong> $${nextSPTBonus} - $${currentSPTBonus} = <strong style="color: #e31837;">-$${sptBonusDiff}</strong>
                                    </div>
                                </div>
                            ` : ''}
                            
                            ${!hoursWorked ? `
                                <div style="background: #fff3cd; padding: 12px; border-radius: 8px; margin-bottom: 12px; border: 1px solid #ffeaa7;">
                                    <strong style="color: #856404;">‚ö†Ô∏è Important:</strong>
                                    <div style="color: #856404; font-size: 0.85rem; margin-top: 4px;">
                                        You didn't work 20+ hours, so you weren't eligible for SPT bonuses. If you had worked 20+ hours AND hit ${nextSPTTier.toFixed(2)} SPT, you would have earned an additional <strong>$${nextSPTBonus}</strong>!
                                    </div>
                                </div>
                            ` : ''}
                            
                            ${minAdditionalSC > 0 ? `
                                <div class="earnings-explainer">
                                    <div class="earnings-title">üíé Service Credit Bonus Impact: ${scBonusDiff > 0 ? '$' + scBonusDiff.toFixed(2) + ' missed' : 'No tier change'}</div>
                                    <div class="earnings-detail">
                                        <strong>How it works:</strong> Each service = at least 1 credit (some like Full Leg = 2+ credits)<br><br>
                                        <strong>Your credits:</strong> ${currentSC} = ${currentSCTier} tier = $${currentSCBonus}<br>
                                        <strong>With ${servicesToAdd} more services:</strong> Would have been ${newSCMin}+ credits = ${newSCTier} tier = $${newSCBonus}<br>
                                        ${scBonusDiff > 0 ? `<strong>You would have moved up a tier!</strong><br>Missed: $${newSCBonus} - $${currentSCBonus} = <strong style="color: #e31837;">-$${scBonusDiff}</strong>` : `<strong>Same tier</strong> (but closer to the next one)`}
                                    </div>
                                </div>
                            ` : ''}
                            
                            ${extraBonusDiff > 0 ? `
                                <div style="background: linear-gradient(135deg, #ffcccc 0%, #ffaaaa 100%); padding: 16px; border-radius: 12px; margin-top: 12px; border: 2px solid #e31837;">
                                    <div style="font-weight: 700; color: #721c24; margin-bottom: 8px; font-size: 1rem;">üò¢ Target Bonus Missed!</div>
                                    <div style="background: rgba(255, 255, 255, 0.9); padding: 12px; border-radius: 8px; margin-bottom: 8px;">
                                        <div style="color: #1a1a1a; font-size: 0.85rem; line-height: 1.6;">
                                            ${newExtraBonus === 200 ? `
                                                <strong>You could have hit all 3 targets!</strong><br>
                                                With ${servicesToAdd} more services, you would have had:<br>
                                                ‚Ä¢ Service Credit target (195+) ‚úì<br>
                                                ‚Ä¢ Retail Credit target (16+) ‚úì<br>
                                                ‚Ä¢ SPT target (1.70+) ‚úì<br><br>
                                                <strong style="font-size: 1.1rem; color: #e31837;">Missed bonus: $${extraBonusDiff}</strong> ${currentExtraBonus > 0 ? `(would have been $${newExtraBonus} instead of $${currentExtraBonus})` : ''}
                                            ` : `
                                                <strong>You could have hit SPT + 1 other target!</strong><br>
                                                Would have unlocked: SPT + ${newServiceTarget ? 'Service' : 'Retail'} target bonus<br><br>
                                                <strong style="font-size: 1.1rem; color: #e31837;">Missed bonus: $${extraBonusDiff}</strong> ${currentExtraBonus > 0 ? `(would have been $${newExtraBonus} instead of $${currentExtraBonus})` : ''}
                                            `}
                                        </div>
                                    </div>
                                </div>
                            ` : currentExtraBonus === 0 && (newServiceTarget || newRetailTarget) && newSPTTarget ? `
                                <div style="background: #fff9e6; padding: 12px; border-radius: 8px; margin-top: 12px; border: 1px solid #ffd700;">
                                    <strong style="color: #856404;">üí° So Close!</strong>
                                    <div style="color: #333; font-size: 0.85rem; margin-top: 6px;">
                                        ${!newRetailTarget ? `You would have still needed ${16 - currentRC} more retail credits to unlock the $100 bonus` : 'You were close to unlocking bonus tiers!'}
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                        
                        ${totalAdditionalEarnings > 0 ? `
                            <div class="earnings-potential" style="margin-top: 16px; background: linear-gradient(135deg, #ffcccc 0%, #ff9999 100%);">
                                <div class="label">üí∏ Total Earnings You Missed Out On</div>
                                <div class="amount" style="color: #721c24;">$${totalAdditionalEarnings.toFixed(2)}</div>
                                <div style="font-size: 0.8rem; margin-top: 8px; opacity: 0.95; color: #721c24;">
                                    This is the extra money you would have earned this pay period if you had added ${servicesToAdd} more services to those ${tickets} guests!
                                </div>
                            </div>
                        ` : ''}
                        
                        <div class="insight-explanation" style="background: #e6f2ff; padding: 14px; border-radius: 8px; margin-top: 16px; border: 2px solid #5b3a82;">
                            <div style="font-size: 0.85rem; line-height: 1.7; color: #333;">
                                <strong style="color: #5b3a82;">üéØ The Takeaway:</strong><br>
                                With those ${tickets} guests, if you had performed ${servicesToAdd} more services (averaging ${(servicesToAdd / tickets).toFixed(2)} per guest), your SPT would have gone from ${currentSPT.toFixed(2)} to ${newSPT.toFixed(2)}, and you would have earned an additional <strong style="color: #e31837; font-size: 1.05rem;">$${totalAdditionalEarnings.toFixed(2)}</strong> this pay period.<br><br>
                                <strong style="color: #5b3a82;">üí™ Going Forward:</strong> Focus on adding that extra service to most guests - it really adds up!
                            </div>
                        </div>
                    </div>
                `;
            } else if (currentSPT >= 2.00) {
                insightsHTML += `
                    <div class="insight-card highlight">
                        <div class="insight-header">üåü Outstanding Performance!</div>
                        <div class="insight-opportunity">
                            <div class="title">You maxed out SPT at ${currentSPT.toFixed(2)}!</div>
                            <div class="detail" style="margin-top: 8px;">You earned the top tier SPT bonus of $400. Amazing work!</div>
                        </div>
                        ${!currentServiceTarget || !currentRetailTarget ? `
                            <div style="margin-top: 12px; padding: 12px; background: #fff9e6; border-radius: 8px;">
                                <strong>üí° Next time:</strong> ${!currentServiceTarget ? `Try to reach 195 service credits to unlock additional bonuses!` : ''} ${!currentRetailTarget ? `Add ${16 - currentRC} more retail sales to hit that target!` : ''}
                            </div>
                        ` : ''}
                    </div>
                `;
            }
            
            // Display insights
            const display = document.getElementById('insightsDisplay');
            display.innerHTML = insightsHTML;
            display.classList.add('show');
            
            // Scroll to insights
            setTimeout(() => {
                display.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
        }

        function updateServiceProgress() {
            const value = parseFloat(document.getElementById('serviceCredits').value) || 0;
            const target = 195;
            const percent = Math.min((value / target) * 100, 100);
            
            const card = document.getElementById('serviceCard');
            const badge = document.getElementById('serviceBadge');
            const progress = document.getElementById('serviceProgress');
            
            progress.style.width = percent + '%';
            document.getElementById('serviceStats').textContent = `${value} / ${target} credits`;
            document.getElementById('servicePercent').textContent = Math.round(percent) + '%';
            
            if (value > 0) card.classList.add('has-value');
            else card.classList.remove('has-value');
            
            if (value >= target) {
                badge.classList.add('met');
                badge.classList.remove('target');
                badge.textContent = '‚úì Target Met';
                progress.classList.add('target-met');
            } else {
                badge.classList.add('target');
                badge.classList.remove('met');
                badge.textContent = 'Target: 195';
                progress.classList.remove('target-met');
            }
        }

        function updateRetailProgress() {
            const value = parseFloat(document.getElementById('retailCredits').value) || 0;
            const target = 16;
            const percent = Math.min((value / target) * 100, 100);
            
            const card = document.getElementById('retailCard');
            const badge = document.getElementById('retailBadge');
            const progress = document.getElementById('retailProgress');
            
            progress.style.width = percent + '%';
            document.getElementById('retailStats').textContent = `${value} / ${target} products`;
            document.getElementById('retailPercent').textContent = Math.round(percent) + '%';
            
            if (value > 0) card.classList.add('has-value');
            else card.classList.remove('has-value');
            
            if (value >= target) {
                badge.classList.add('met');
                badge.classList.remove('target');
                badge.textContent = '‚úì Target Met';
                progress.classList.add('target-met');
            } else {
                badge.classList.add('target');
                badge.classList.remove('met');
                badge.textContent = 'Target: 16';
                progress.classList.remove('target-met');
            }
        }

        function updateSPTProgress() {
            const value = parseFloat(document.getElementById('spt').value) || 0;
            const hoursWorked = document.getElementById('hoursWorked').checked;
            const target = 1.70;
            const percent = Math.min((value / target) * 100, 100);
            
            const card = document.getElementById('sptCard');
            const badge = document.getElementById('sptBadge');
            const progress = document.getElementById('sptProgress');
            
            progress.style.width = percent + '%';
            document.getElementById('sptStats').textContent = `${value.toFixed(2)} / ${target.toFixed(2)} SPT`;
            document.getElementById('sptPercent').textContent = Math.round(percent) + '%';
            
            if (value > 0) card.classList.add('has-value');
            else card.classList.remove('has-value');
            
            if (value >= target && hoursWorked) {
                badge.classList.add('met');
                badge.classList.remove('target');
                badge.textContent = '‚úì Target Met';
                progress.classList.add('target-met');
            } else {
                badge.classList.add('target');
                badge.classList.remove('met');
                badge.textContent = 'Target: 1.70';
                progress.classList.remove('target-met');
            }
        }

        function calculate() {
            const s = parseFloat(document.getElementById('serviceCredits').value) || 0;
            const r = parseFloat(document.getElementById('retailCredits').value) || 0;
            const p = parseFloat(document.getElementById('spt').value) || 0;
            const h = document.getElementById('hoursWorked').checked;

            let sb = 0, st = '';
            if (s >= 366) { sb = 425 + (s - 365) * 1.50; st = 'Tier 366+'; }
            else if (s >= 326) { sb = 425; st = 'Tier 326-365'; }
            else if (s >= 281) { sb = 275; st = 'Tier 281-325'; }
            else if (s >= 226) { sb = 115; st = 'Tier 226-280'; }
            else if (s >= 195) { sb = 80; st = 'Tier 195-225'; }
            else if (s >= 142) { sb = 25; st = 'Tier 142-194'; }
            else { sb = 0; st = 'Tier 0-141'; }

            let rb = 0, rt = '';
            if (r >= 28) { rb = 80 + (r - 28) * 2; rt = 'Tier 28+'; }
            else if (r >= 23) { rb = 70; rt = 'Tier 23-27'; }
            else if (r >= 19) { rb = 55; rt = 'Tier 19-22'; }
            else if (r >= 16) { rb = 40; rt = 'Tier 16-18'; }
            else if (r >= 13) { rb = 30; rt = 'Tier 13-15'; }
            else if (r >= 9) { rb = 20; rt = 'Tier 9-12'; }
            else { rb = 0; rt = 'Tier 0-8'; }

            let pb = 0, pt = '';
            if (!h) { pb = 0; pt = '< 20 hours'; }
            else if (p >= 2.00) { pb = 400; pt = 'Tier 2.00+'; }
            else if (p >= 1.90) { pb = 350; pt = 'Tier 1.90-1.99'; }
            else if (p >= 1.80) { pb = 300; pt = 'Tier 1.80-1.89'; }
            else if (p >= 1.70) { pb = 250; pt = 'Tier 1.70-1.79'; }
            else if (p >= 1.60) { pb = 185; pt = 'Tier 1.60-1.69'; }
            else if (p >= 1.50) { pb = 125; pt = 'Tier 1.50-1.59'; }
            else { pb = 0; pt = 'Tier < 1.50'; }

            const sTarget = s >= 195;
            const rTarget = r >= 16;
            const pTarget = p >= 1.70 && h;

            let extra = 0, extraText = '';
            if (sTarget && rTarget && pTarget) {
                extra = 200;
                extraText = 'üéâ All 3 Targets Hit!';
            } else if (pTarget && (sTarget || rTarget)) {
                extra = 100;
                extraText = '‚≠ê SPT + 1 Target Hit!';
            }

            let targetHTML = `
                <div class="target-chip ${sTarget ? 'met' : 'missed'}">
                    <div class="icon">${sTarget ? '‚úì' : '‚úó'}</div>
                    <div class="label">Service</div>
                </div>
                <div class="target-chip ${rTarget ? 'met' : 'missed'}">
                    <div class="icon">${rTarget ? '‚úì' : '‚úó'}</div>
                    <div class="label">Retail</div>
                </div>
                <div class="target-chip ${pTarget ? 'met' : 'missed'}">
                    <div class="icon">${pTarget ? '‚úì' : '‚úó'}</div>
                    <div class="label">SPT</div>
                </div>
            `;
            document.getElementById('targetOverview').innerHTML = targetHTML;

            const extraContainer = document.getElementById('extraBonusContainer');
            if (extra > 0) {
                extraContainer.innerHTML = `
                    <div class="extra-bonus-card">
                        <div class="icon">üéÅ</div>
                        <div class="text">${extraText} +$${extra}</div>
                    </div>
                `;
            } else {
                extraContainer.innerHTML = '';
            }

            document.getElementById('serviceAmount').textContent = '$' + sb.toFixed(2);
            document.getElementById('serviceTier').textContent = st;
            document.getElementById('retailAmount').textContent = '$' + rb.toFixed(2);
            document.getElementById('retailTier').textContent = rt;
            document.getElementById('sptAmount').textContent = '$' + pb.toFixed(2);
            document.getElementById('sptTier').textContent = pt;

            const total = sb + rb + pb + extra;
            document.getElementById('totalAmount').textContent = '$' + total.toFixed(2);

            document.getElementById('results').classList.add('show');
            document.getElementById('printBtn').classList.add('show');
            
            // Show analytics section after results
            document.getElementById('analyticsSection').style.display = 'block';
            
            // Highlight current tiers
            highlightCurrentTiers(s, r, p);

            setTimeout(() => {
                document.getElementById('results').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 100);
        }
        
        function highlightCurrentTiers(serviceCredits, retailCredits, spt) {
            // Clear previous current highlights
            document.querySelectorAll('.tier-row.current').forEach(row => {
                row.classList.remove('current');
            });
            
            // Highlight service credit tier
            const serviceTiers = document.querySelectorAll('#serviceTierTable .tier-row');
            serviceTiers.forEach(row => {
                const min = parseFloat(row.dataset.min);
                const max = parseFloat(row.dataset.max);
                if (serviceCredits >= min && serviceCredits <= max) {
                    row.classList.add('current');
                }
            });
            
            // Highlight retail credit tier
            const retailTiers = document.querySelectorAll('#retailTierTable .tier-row');
            retailTiers.forEach(row => {
                const min = parseFloat(row.dataset.min);
                const max = parseFloat(row.dataset.max);
                if (retailCredits >= min && retailCredits <= max) {
                    row.classList.add('current');
                }
            });
            
            // Highlight SPT tier
            const sptTiers = document.querySelectorAll('#sptTierTable .tier-row');
            sptTiers.forEach(row => {
                const min = parseFloat(row.dataset.min);
                const max = parseFloat(row.dataset.max);
                if (spt >= min && spt <= max) {
                    row.classList.add('current');
                }
            });
        }

        function reset() {
            document.getElementById('serviceCredits').value = '';
            document.getElementById('retailCredits').value = '';
            document.getElementById('spt').value = '';
            document.getElementById('hoursWorked').checked = true;

            updateServiceProgress();
            updateRetailProgress();
            updateSPTProgress();

            document.getElementById('results').classList.remove('show');
            document.getElementById('printBtn').classList.remove('show');
            
            // Hide analytics section
            document.getElementById('analyticsSection').style.display = 'none';
            
            // Clear analytics inputs and insights
            document.getElementById('totalTickets').value = '';
            document.getElementById('totalServices').value = '';
            document.getElementById('insightsDisplay').innerHTML = '';
            document.getElementById('insightsDisplay').classList.remove('show');
            document.getElementById('analyticsContent').classList.remove('open');
            document.getElementById('analyticsToggle').classList.remove('open');
            
            // Clear tier highlights
            document.querySelectorAll('.tier-row.current').forEach(row => {
                row.classList.remove('current');
            });

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html>
